---
title: "How I Set Up TrueNAS SCALE on Proxmox and Got Time Machine Backups Working"
date: "2025-07-20"
author: "Subhasis Bose"
summary: "In this blog, I walk through how I set up TrueNAS SCALE on a Proxmox VM in my homelab, configured a storage pool, and successfully enabled Time Machine backups over SMB for my macOS system—all from scratch."
tags: ["homelab", "truenas", "truenas-scale", "proxmox", "timemachine", "zfs", "nas", "virtualization", "smb", "macos", "backup", "storage", "self-hosted"]
category: "Setup"
image: "/blog-images/202507201950/truenas.webp"
---

# How I Set Up TrueNAS SCALE on Proxmox and Got Time Machine Backups Working

Hey folks,

Just wrapped up a really fun project in my homelab that I thought I'd document: I set up **TrueNAS SCALE** on my **Proxmox server**, configured it as a proper NAS, and got **macOS Time Machine backups** working over the network. If you're into homelabbing or just want to nerd out over storage, this one’s for you.

Here’s what I did—from spinning up the TrueNAS VM all the way to watching macOS happily backing up over SMB.

---

## Step 1: Spinning Up TrueNAS SCALE on Proxmox

First things first—I wanted to keep my lab neat and avoid dedicating an entire box just for TrueNAS. Since I'm already running **Proxmox** as my virtualization host, I figured I'd set up TrueNAS as a **virtual machine (VM)** there.

### VM Specs I Used:
- **CPU**: 4 Cores (host-passthrough)
- **RAM**: 12 GB
- **Boot Disk**: 32 GB (VirtIO SCSI)
- **Disks**: USB 2.0 direct pass through for external hard drive.
- **Network**: VirtIO NIC bridged to `vmbr0`
- **BIOS**: UEFI BIOS enabled

I downloaded the latest **TrueNAS SCALE ISO**, uploaded it to Proxmox, and created a new VM with the above settings. Without UEFI, the installation process might fail so enabling a bios UEFI option in the VM settings is a must.

---
## Step 2: Getting Into the TrueNAS UI

Once I installed TrueNAS SCALE inside the VM, it booted up and gave me an IP address in the console. I jumped onto my browser and accessed the UI at:

```
http://<ip provided by dhcp>
```

At the login screen, I used the `admin` username and the password I had set during installation. Smooth sailing so far!

---
## Step 3: Updating the System & Setting Static IP

Right after logging in, the first thing I did was run the **system update** to make sure I had the latest patches and fixes. It was as simple as going to:

> **System Settings → Update → Check for Updates**

I ran the update and then rebooted the VM.

After that, I headed into **Network Settings** and reconfigured the main interface to use a **static IP** instead of DHCP. Just made life easier for mapping, mounting, and general peace of mind.

---
## Step 4: Creating the Storage Pool

Next up, I created my **main storage pool**.

In the UI:
- Went to **Storage → Pools → Add**
- Selected my HDDs (that were passed through from Proxmox)
- Chose **stripe** as I do not need any redundancy
- Named it something simple like `data`

It took just a few seconds and the pool was ready.

---
## Step 5: Setting Up Time Machine Support

This is the part I was most excited about—backing up my Mac over the network to the NAS.

### ➕ Created a Time Machine Dataset
I went to:
> **Storage → Pools → data → Add Dataset**

I named it `timemachine`, chose the **SMB share type**, and made sure ACLs were enabled (macOS needs it).

### Created a User for Time Machine
Then I created a new user:
> **Credentials → Local Users → Add**

- **Username**: `timemachine`
- Set a strong password (I’d need this on my Mac later)
- Left everything else default

### Set ACL and Permissions
After that, I headed back to the `timemachine` dataset and edited its **permissions**:

- Gave full control to the `timemachine` user
- Used the **Open ACL preset** for simplicity

### Created an SMB Share
Then I went to:
> **Sharing → Windows (SMB) Shares → Add**

- **Path**: pointed to `/mnt/data/timemachine`
- **Name**: `TimeMachine`
- Enabled “Use as Time Machine share”
- Enabled “Enable Apple SMB2/3 Extensions” - This would not directly be under the share settings, but under the SMB settings.

Saved it, and restarted the **SMB service** when prompted.

### Optional: Set a Quota
Because Time Machine will happily eat all the space it sees, I went back to the `timemachine` dataset and set a **quota** of 500 GB.

---

## Step 6: Connecting Time Machine from macOS

Now the fun part—on my Mac, I did:

1. Pressed **Cmd + K** to open “Connect to Server”
2. Entered:
   ```
   smb://192.168.1.120/TimeMachine
   ```
3. Logged in with the `timemachine` username and password - this might give an error and not connect, that is fine, I just wanted to check if the share was visible over the network.
4. Went to **System Settings → General → Time Machine**
5. Clicked “Select Disk” → Picked the `TimeMachine` share

And boom—macOS started its initial backup!

---

## The Result

Everything worked beautifully. I now have a fully virtualized **TrueNAS SCALE instance inside Proxmox**, managing disks, acting as a rock-solid NAS, and even handling **Time Machine backups** over SMB.

---

## Lessons Learned

- PCI passthrough for storage is recommended
- Time Machine requires some SMB tweaks, but it’s totally doable
- TrueNAS SCALE is very stable, even as a VM inside Proxmox

---

Next I can use this TrueNAS instance to provide storage directly for my Proxmox VMs or k8s cluster. Will see what route it goes.

Happy labbing!!