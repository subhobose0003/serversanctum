---
title: "Building a GitOps Kubernetes Homelab"
date: "2025-07-20"
author: "Subhasis Bose"
summary: "A hands-on journey to migrate my homelab workloads to Kubernetes using a GitOps workflow. This setup is designed for learning, experimentation, and building a production-like environment with declarative infrastructure."
tags: ["GitOps", "Homelab", "Kubernetes", "DevOps", "Talos Linux", "Infrastructure", "FluxCD", "ArgoCD", "Infrastructure as Code", "Self-Hosting", "CI/CD", "Cluster Management", "Learning in Public"]
category: "GitOps"
image: "/blog-images/202507201056/gitops-homelab.webp"
---

# Building a GitOps Kubernetes Homelab

I’ve been planning to move all my workloads in the homelab to Kubernetes, and I figured this would be a good opportunity to try out a complete GitOps workflow. It’s mainly for learning, not for solving any pressing problem. I want to simulate how a full GitOps-based setup might look in a production-like environment, but within the comfort of my own lab.

The idea is to treat this as an iterative project—starting small and building it up over time, making sure I understand how everything connects. I’ll break down what I’m aiming for, the tools I want to use, and how I plan to structure and automate the setup.

---

### Goal

The primary goal is to build a GitOps-driven Kubernetes setup that mimics a real-world, production-ready environment. I want to:
- Learn how to manage clusters declaratively using Git as the source of truth.
- Set up separate environments (non-prod and prod) to simulate real-world workflows.
- Build out the infrastructure with a layered, reproducible approach.

---

### Cluster Setup

I’ll be running two Kubernetes clusters:

1. **Non-Prod** — for testing, development, staging.
2. **Prod** — a more stable, controlled cluster that mirrors production setups.

I’m using **Talos Linux** as the OS for these clusters. It’s minimal, secure, and managed entirely through declarative configs—so it fits perfectly with the GitOps approach.

---

### Core Infrastructure Stack

Here’s what I plan to deploy across both clusters:

- **ExternalDNS** – for dynamic DNS updates.
- **MetalLB** – for bare-metal load balancing.
- **Cert-Manager** – to automate TLS certs.
- **Longhorn** – as a distributed block storage solution.
- **Traefik** – for ingress and load balancing.
- **MinIO** – for object storage.
- **Vault** – for managing secrets.

I might add more tools later, but this feels like a solid base to start with.

---

### GitOps Workflow

The plan is to manage everything via Git:

- I’ll have a **mono-repo** (or maybe split repos depending on how messy it gets) with folders for each environment.
- Changes will go through Pull Requests.
- Each environment will have its own branch (e.g., `main` for prod, `dev` for non-prod).
- I’ll be using Flux or Argo CD (still deciding) to reconcile state from Git to the clusters.

This way, I can test everything in non-prod first, and then promote changes to prod by simply merging branches.

---

### Implementation Plan

Here’s how I’m breaking things down:

1. **Bootstrap Clusters**: Install Talos, bring up both Kubernetes clusters, and verify connectivity.
2. **Set Up Git Repos**: Organize repos, branch structure, and basic readme/docs.
3. **Deploy Core Services**: Install the tools listed above in non-prod first, then replicate to prod.
4. **CI/CD Integration**: Set up pipelines (maybe GitHub Actions or Drone) to validate changes before merges.
5. **Environments**: Define dev and prod overlays, using tools like `kustomize` or `helm` if needed.
6. **Secrets Management**: Integrate Vault properly and ensure secrets aren’t exposed in Git.
7. **Documentation**: Keep track of everything—decisions made, configs used, and things that broke.

---

### Challenges I Expect

- **Networking**: Making MetalLB and external DNS play nicely might need some trial and error.
- **Storage**: Longhorn looks promising but I haven’t used it at scale yet.
- **Secrets**: Figuring out the best way to sync secrets securely is going to be a challenge.

---

### What I Hope to Get Out of This

Mainly, I want to learn by doing. I’ve read about GitOps a lot, used some of the tools here and there, but I haven’t seen how they all come together in a real environment that I control. By the end, I’m hoping I’ll have:

- A better grasp of GitOps workflows.
- A fully declarative, reproducible Kubernetes setup.
- Experience troubleshooting and maintaining something more realistic than a local `kind` cluster.

---

### What’s Next

Once I have the basics in place, I might expand into more advanced setups:

- Add a **service mesh** like Linkerd.
- Experiment with **multi-cloud** or remote clusters.
- Integrate **machine learning pipelines** or other heavier workloads.

But for now, it’s all about taking one step at a time and understanding what I’m doing—not just copy-pasting charts and hoping they work.

If you’re doing something similar or have ideas, feel free to reach out. I’m always up for learning more.

---

Happy labbing!!